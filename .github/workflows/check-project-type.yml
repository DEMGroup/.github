name: Check Project type (and guard pr for default branch)

on:
    workflow_call:

jobs:
  check-project-type:
    if: ${{ github.event_name == 'pull_request' && github.base_ref == github.event.repository.default_branch }}
    runs-on: ubuntu-latest
    outputs:
      isDotnet: ${{ steps.check.outputs.isDotnet }}
      isNode: ${{ steps.check.outputs.isNode }}
    steps:
    - uses: actions/checkout@v3
    - name: Project Type Checker
      id: check
      run: |
        isDotnet=false
        if test -n "$(find . -name '*.sln')"; then
            isDotnet=true
        fi
        echo "isDotnet=$isDotnet" >> $GITHUB_OUTPUT
        isNode=false
        if test -n "$(find . -name 'package.json')"; then
            isNode=true
        fi
        echo "isNode=$isNode" >> $GITHUB_OUTPUT